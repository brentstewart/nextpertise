<!doctype html>
  <html lang="en">
  <head itemscope itemtype="https://nextpertise.net/">
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-173443199-1');
      </script>
    <title>Nextpertise Sudo for Windows Powershell - a personal journal of interesting ideas</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://Nextpertise.net/style.css">
    <link rel="icon" href="/n.ico">
    <meta http-equiv="content-type" content="text/html; charset=windows-1252">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-173443199-1"></script>
    


  </head>
  <body>
    <link rel="stylesheet" href="https://nextpertise.net/bootstrap-table.css">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Nextpertise is a journal of interesting ideas: Some Windows Powershell commands must be run from Powershell running in an administrative context. It&rsquo;s a little bit of a pain when you need to invoke Powershell this way (right click it in the menu).">
    <meta name="keywords" content="Windows, Shell,Windows Sudo" />
    <meta name="twitter:card" content="">
    <meta property="og:title" content="Sudo for Windows Powershell" >
    <meta property="og:url" content="https://nextpertise.net/posts/220124_sudo_on_windows/" >
    <meta property="og:description" content="" >
    <meta property="og:image" content="https://nextpertise.net/non-technical.png" >
    <link rel="apple-touch-icon" href="https://nextpertise.net/non-technical.png" >
    <link rel="stylesheet" href="https://nextpertise.net/style.css" >
</head>
<div class="tags"><img src="https://nextpertise.net/nextpertise_rays.png" alt="Nextpertise" height="75" > <i>a journal of interesting technical ideas . . .</i></div>
<div class="nav"style="text-align: left">
  <nav class="sidebar-nav">
    
    
      <a class="sidebar-nav-item" href="/" title="">Home
    
      <a class="sidebar-nav-item" href="/tags/" title="">TagCloud
    
      <a class="sidebar-nav-item" href="/posts/" title="">Archives
    
      <a class="sidebar-nav-item" href="https://stewart.tc/" title="">Personal
    
      <a class="sidebar-nav-item" href="https://stewart.tc/reading/" title="">Reading
    
      <a class="sidebar-nav-item" href="https://github.com/brentstewart" title="">Github
    
      <a class="sidebar-nav-item" href="/links" title="">Links
    
      <a class="sidebar-nav-item" href="/contributors" title="">About
    
    &NonBreakingSpace;Find us on:&NonBreakingSpace;
    <a href="https://nextpertise.net/index.xml"><img src="/Feed-icon.png" alt="RSS" height="25" >
    <a href="https://www.linkedin.com/company/nextpertise"><img src="/linkedin.png" alt="LinkedIn" height="25" >
    
  </div>

    
<img src="/windows.png#floatright" height="140">
<h1>Sudo for Windows Powershell</h1> 
  <h6><div style="text-align: right"><i>by Brent Stewart  on Sunday, Jan 23, 2022</i><br></div></h6>
  <p><p>Some Windows Powershell commands must be run from Powershell running in an administrative context.  It&rsquo;s a little bit of a pain when you need to invoke Powershell this way (right click it in the menu).  The real problem is once there&rsquo;s a terminal up, do you limit this to just the command that requires it or do you just work out of the open (administrative) terminal window?  Choosing to remain in that admin context could lead to trouble.</p>
<p><img src="/sudologo.png#floatsmallleft" alt="Sudo Logo"></p>
<h2 id="the-need-for-sudo">The need for sudo</h2>
<p>Unix has a nice way of handling this.  The command prompt starts with your user priviledges.  It can be escalated for a single command with &ldquo;sudo&rdquo; - substitute user do.  Wouldn&rsquo;t it be cool (and more secure) if a similar command existed for Powershell on Windows?</p>
<p>Luke Sampson has a set of powershell scripts that appropximate Linux commands on <a href="https://github.com/lukesampson/psutils/blob/master/sudo.ps1">Github.  These include sudo and are meant to be installed using <em>scoop</em>.</p>
<h2 id="using-scoop">Using Scoop</h2>
<p>Scoop is an installer, like winget or choco, but it&rsquo;s aimed more at simple installs.  Scoop doesn&rsquo;t require a developer to make a special installer - it can use a ZIP and instructions in a JSON.  These JSON files are stored in buckets - basically these are curated compilations of JSON files stored in a Git.</p>
<p>Scoop specializes in simple programs, like command-line tools such as sudo.  In fact, many linux-like tools can be easily installed by scoop such as sudo, git, and curl.  Scoop puts everything in your users directory, so it doesn&rsquo;t cause a lot of UAC pop-ups.</p>
<p>Scoop and sudo can be installed as shown below.</p>
<pre><code># allow powershell scripts
Set-ExecutionPolicy unrestricted
# install scoop
iwr -useb get.scoop.sh |iex
# install sudo 
scoop install sudo
</code></pre>
<p>You can use <strong>scoop search</strong> to see if a program is available through scoop.  Check out the github site to see other buckets that are available as well.</p>
<h2 id="using-sudo-in-powershell-for-windows">Using Sudo in Powershell for Windows</h2>
<p>Once installed, you can escalate priviledges on a command-by-command basis by prefixing them with &ldquo;sudo&rdquo;, just like you would on Linux.</p>
<pre><code>sudo set-executionpolicy
</code></pre>
</p>
  <br>
  <hr>
  <h6>
    <strong>References:<br></strong> &nbsp&nbsp<a href="https://github.com/lukesampson/psutils/blob/master/sudo.ps1">https://github.com/lukesampson/psutils/blob/master/sudo.ps1<br> &nbsp&nbsp<a href="https://scoop.sh/">https://scoop.sh/<br> &nbsp&nbsp<a href="https://github.com/ScoopInstaller/Scoop">https://github.com/ScoopInstaller/Scoop<br> 
    
    
    <br>
    Recent articles related to these tags:
    
      
        <a href="/tags/windows/">Windows 
       
        <a href="/tags/shell/">Shell 
       
    
    <ul style="list-style: none;">
      
      <li class="relatedPost">
        <a href="/posts/230305_carbonyl/">Command Line Browser Carbonyl<br />
        
      </li>
    
      <li class="relatedPost">
        <a href="/posts/221226_fancywm/">FancyWM<br />
        
      </li>
    
      <li class="relatedPost">
        <a href="/posts/220404_winkey/">Finding Windows Keys on Hardware<br />
        
      </li>
    
      <li class="relatedPost">
        <a href="/posts/220124_oh_my_posh/">Oh My Posh<br />
        
      </li>
    
      <li class="relatedPost">
        <a href="/posts/211228_winget/">Winget<br />
        
      </li>
    
  </ul>
<br>


    
Share this article:&NonBreakingSpace;
  <script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
  <script type="IN/Share" data-url="/posts/220124_sudo_on_windows/"></script>&NonBreakingSpace;
  <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</h6>
  <script
    async
    src="https://utteranc.es/client.js"
    repo="brentstewart/nextpertise"
    issue-term="title"
    theme="github-light"
    crossorigin="anonymous"></script>
  
    <div class="nav" style="position:fixed; color: white; background-color:lightgray; bottom:0px; text-align:center; width:100%">
     <nav class ="sidebar-nav"><a href="/">Sudo for Windows Powershell</nav>
</div>
  </body>
  </html>
