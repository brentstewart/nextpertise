<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Virtualization on </title>
    <link>https://www.nextpertise.net/tags/virtualization/</link>
    <description>Recent content in Virtualization on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 21 Apr 2021 20:11:14 -0400</lastBuildDate>
    
        <atom:link href="https://www.nextpertise.net/tags/virtualization/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>GNS3 Attached to ESXi</title>
      <link>https://www.nextpertise.net/posts/210421_gns3_attached_to_esxi/</link>
      <pubDate>Wed, 21 Apr 2021 20:11:14 -0400</pubDate>
      
      <guid>https://www.nextpertise.net/posts/210421_gns3_attached_to_esxi/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://www.nextpertise.net/210421_GNS3-30.png#floatsmallleft&#34; alt=&#34;VLAN Setup&#34;&gt;&lt;/p&gt;
&lt;p&gt;I got a little distracted.  I have been coming up to speed on Ansible, which got me started on Vagrant.  Vagrant got me building VMs in VMWare Workstation , which got me thinking how neat it would be to place those &lt;em&gt;automagically&lt;/em&gt; into my GNS3VM environment hosted on ESXi.  Didn&amp;rsquo;t get that far - yet  - but the progress I made is pretty cool in it&amp;rsquo;s own right.&lt;/p&gt;
&lt;p&gt;Most GNS3 users are using a GNS3 VM to host their topologies.  Mine sits on an ESXi server.  I discussed a few days ago how to connect GNS3 into a network (see &lt;a href=&#34;https://www.nextpertise.net/210417_Connecting_GNS3&#34;&gt;Connecting GNS3&lt;/a&gt;). Here I want to do something more complex - I&amp;rsquo;d like to connect ESXi instances into arbitrary points in a GNS3 network.  The topology will still have a connection &amp;ldquo;out&amp;rdquo; to the home network and Internet, but I want to add an ESXi VM &amp;ldquo;inside&amp;rdquo; the network as well.&lt;/p&gt;
&lt;p&gt;The approach I used was to attach the VMs into an ESXi VSwitch VLAN and then use additional cloud appliances to attach those VLAN into the GNS3 topology.  &lt;em&gt;This seems obvious in retrospect&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id=&#34;setup-on-esxi&#34;&gt;Setup on ESXi&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://www.nextpertise.net/210422_GNS3Shell.png#floatsmallright&#34; alt=&#34;Alt&#34;&gt;
The first step is to go onto the VMWare ESXi server and create a new VLAN on the vSwitch.  From the ESXi management interface, select the networking tab and &amp;ldquo;add port group&amp;rdquo;.  I created VLAN 30 and called it &amp;ldquo;GNS3-30&amp;rdquo; and assigned it to my default virtual switch (vSwitch0).&lt;/p&gt;
&lt;h2 id=&#34;setup-the-gns3vm&#34;&gt;Setup the GNS3VM&lt;/h2&gt;
&lt;p&gt;Next I went to the GNS3vm VMWare properties and added an interface.  The interface will attach to the VM &amp;ldquo;live&amp;rdquo;, but you&amp;rsquo;ll need to go into the GNS3vm to configure it before it can be used.&lt;/p&gt;
&lt;p&gt;To setup the interface, login and choose &amp;ldquo;Shell&amp;rdquo; from the main menu.  The interface needs to be added to &lt;strong&gt;netplan&lt;/strong&gt;.  I ended up adding two interfaces (more fun!) and also took the chance to set a static IP for my server.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;cd /etc/netplan  
ls  
sudo nano 90_gns3vm_static_netcfg.yaml  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here&amp;rsquo;s the edited YAML file I&amp;rsquo;m using.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;network&lt;/span&gt;:
  &lt;span style=&#34;color:#f92672&#34;&gt;version&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;  
  &lt;span style=&#34;color:#f92672&#34;&gt;renderer&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;networkd  &lt;/span&gt;
  &lt;span style=&#34;color:#f92672&#34;&gt;ethernets&lt;/span&gt;:  
    &lt;span style=&#34;color:#f92672&#34;&gt;eth0&lt;/span&gt;:  
      &lt;span style=&#34;color:#f92672&#34;&gt;dhcp4&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;no&lt;/span&gt;  
      &lt;span style=&#34;color:#f92672&#34;&gt;addresses&lt;/span&gt;: [&lt;span style=&#34;color:#ae81ff&#34;&gt;192.168.25.52&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;/24]  &lt;/span&gt;
      &lt;span style=&#34;color:#f92672&#34;&gt;gateway4&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;192.168.25.1&lt;/span&gt;  
      &lt;span style=&#34;color:#f92672&#34;&gt;nameservers&lt;/span&gt;:  
        &lt;span style=&#34;color:#f92672&#34;&gt;addresses&lt;/span&gt;: [&lt;span style=&#34;color:#ae81ff&#34;&gt;8.8.8.8&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;8.8.4.4&lt;/span&gt;]  
    &lt;span style=&#34;color:#f92672&#34;&gt;eth1&lt;/span&gt;:  
      &lt;span style=&#34;color:#f92672&#34;&gt;dhcp4&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;no&lt;/span&gt;  
    &lt;span style=&#34;color:#f92672&#34;&gt;eth2&lt;/span&gt;:  
      &lt;span style=&#34;color:#f92672&#34;&gt;dhcp4&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;no&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;When I did this step, it replaced the existing eth0 on the GNS3VM and made my old interface eth1.  This disconnected the VM because the IP information was associated with eth0.  I diagnosed this by using the VMWare interface and the &lt;em&gt;ifconfig&lt;/em&gt; command on the GNS3VM to identify and associate names and MAC addresses, but it took a little time to understand what happened.  I&amp;rsquo;m still not sure why, but be alert for this issue if you add an interface.  My Internet GNS3 cloud appliance had to be disconnected (you cannot add interfaces to a cloud with existing connections), eth1 added, and reconnected to get it to work.&lt;/p&gt;
&lt;h2 id=&#34;adding-to-gns3-topology&#34;&gt;Adding to GNS3 Topology&lt;/h2&gt;
&lt;p&gt;Recall from &lt;a href=&#34;https://www.nextpertise.net/210417_Connecting_GNS3&#34;&gt;Connecting GNS3&lt;/a&gt; that I&amp;rsquo;ve setup my home network to expect a GNS3 border router at 192.168.25.82 and it will be the route to 192.168.28.0/22.  In this simplest case, I&amp;rsquo;m attaching another interface on that same router to a different vSwitch VLAN and routing between them.  I &lt;em&gt;could&lt;/em&gt; have put the new VLAN deep in the GNS3 topology.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://www.nextpertise.net/210422_AddingACloud.png#center&#34; alt=&#34;Setup in GNS3&#34;&gt;&lt;/p&gt;
&lt;p&gt;So pause before this next paragraph.  Recall that there are three contexts, one physical, one in terms of the ESXi vSwitch, and one inside GNS3.&lt;/p&gt;
&lt;p&gt;Attaching a new cloud (in GNS3) that uses the GNS3VM interface (in the vSwitch context) attached to the new VLAN (in my case, eth0 -&amp;gt; VLAN30) will bring that new network into the virtual lab.&lt;/p&gt;
&lt;p&gt;At this point I attached a Windows VM to the new VLAN and set it&amp;rsquo;s interface to DHCP.  I connected the cloud to the virtual router (in GNS3), setup the interface, and added DHCP server capability.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-plaintext&#34; data-lang=&#34;plaintext&#34;&gt;int g0/2  
  ip add 192.168.30.1 255.255.255.224  
ip dhcp pool GNS3  
  network 192.168.30.0 /27  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I can verify that this works inside the Windows VM, and by verifying that an IP has been assigned from the router.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-plaintext&#34; data-lang=&#34;plaintext&#34;&gt;Router1# __sh ip dhcp bindings__  
Bindings from all pools not associated with VRF:  
IP address   Client-ID/        Lease expiration    Type
             Hardware address/  
             User name  
192.168.30.2 0100.0c29.e965.fd Apr 30 2021 12:05 AM  Automatic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;whats-next&#34;&gt;What&amp;rsquo;s next?&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;d really like to be able to &lt;strong&gt;Vagrant up&lt;/strong&gt; straight into GNS3.  I&amp;rsquo;m not even sure why, except that it would be cool.  Right now I can build a VM on Workstation, transfer it to ESXi and place it in the VLAN and thus in the GNS3 topology.&lt;/p&gt;
&lt;p&gt;I can easily extend the vSwitch VLAN to my home network, but for this to really work I&amp;rsquo;ll need to implement a trunk to my desktop and be able to place Workstation VMs into the VLAN.&lt;/p&gt;
&lt;p&gt;One of the things I love about GNS3 is that it pushes me to understand things and learn new techniques.  I&amp;rsquo;ll work on that as I have time in the days ahead.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>VMWare 3D Acceleration</title>
      <link>https://www.nextpertise.net/posts/200728_vmware_3d_acceleration/</link>
      <pubDate>Tue, 28 Jul 2020 15:44:02 -0400</pubDate>
      
      <guid>https://www.nextpertise.net/posts/200728_vmware_3d_acceleration/</guid>
      <description>&lt;p&gt;I tried to load Chrome OS in VMWare Workstation the other day and got the message &amp;ldquo;No 3D Support is available&amp;rdquo;.  Apparently this is required for Chrome OS to boot.  I&amp;rsquo;ve gotten the message on other VMs, but never needed to worry about it.&lt;/p&gt;
&lt;p&gt;I assumed this was an issue with Chrome OS at first and tried several versions including &amp;ldquo;CloudReady&amp;rdquo;.  I was using the build put together by FydeOS and had a chance to talk with him on Telegram about the issue.  He recommended I look through a question on AskUbuntu.&lt;/p&gt;
&lt;p&gt;I edited &lt;strong&gt;.vmware/preferences&lt;/strong&gt; and added the following line.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mks.gl.allowBlacklistedDrivers = &amp;quot;TRUE&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Chrome OS booted without a problem!  I had VMs on ESXi that I was accessing via Workstation, and this also resolved the issue for them.  If you are interested in running a ChromeOS VM, I suggest checking out FydeOS.  My testing has been smooth and they have a Telegram channel that is super helpful.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
